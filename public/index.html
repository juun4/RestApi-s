<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>JunnAPIs â€¢ Free & Simple REST Endpoints</title>

  <!-- Fonts (opsional) -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet"/>

  <!-- PENTING: path-nya /style.css (tanpa /public) + cache bust -->
  <link rel="stylesheet" href="/style.css?v=2">
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <svg width="34" height="34" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M5 12h14M12 5v14" stroke="#7aa2ff" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <div>
          <h1 id="siteName">JunnAPIs</h1>
          <div class="tag" id="tagline">Free &amp; Simple REST Endpoints</div>
        </div>
      </div>
      <div class="cta">
        <a id="repoLink" class="btn btn-ghost" target="_blank" rel="noreferrer">GitHub</a>
        <a id="deployLink" class="btn btn-grad" target="_blank" rel="noreferrer">Open</a>
      </div>
    </header>

    <div id="content"></div>

    <footer>Made by <b id="creator">juun4</b></footer>
  </div>

  <script>
    async function main(){
      const res = await fetch('/src/web-set.json',{cache:'no-store'});
      const cfg = await res.json();

      // Branding
      document.getElementById('siteName').textContent = cfg?.branding?.siteName ?? 'JunnAPIs';
      document.getElementById('tagline').textContent  = cfg?.branding?.tagline  ?? 'Free & Simple REST Endpoints';
      document.getElementById('creator').textContent  = cfg?.apiSettings?.creator ?? 'unknown';
      const repo = document.getElementById('repoLink'); repo.href = cfg?.branding?.repo || '#';
      const dep  = document.getElementById('deployLink'); dep.href = cfg?.branding?.deployUrl || '#';

      const categories = (cfg.categories || []).slice()
        .sort((a,b)=>(a.order??99)-(b.order??99));

      const mount = document.getElementById('content');
      mount.innerHTML = '';

      for (const cat of categories){
        const sec = document.createElement('section');
        sec.className = 'section';

        const h2 = document.createElement('h2');
        h2.innerHTML = `${cat.icon || 'ðŸ“¦'} <span>${cat.title || 'Category'}</span>`;
        sec.appendChild(h2);

        const grid = document.createElement('div'); grid.className='grid';

        for (const it of (cat.items||[])){
          const card = document.createElement('div'); card.className='item';

          const t = document.createElement('div'); t.className='title';
          t.textContent = it.title || 'Untitled';
          card.appendChild(t);

          const d = document.createElement('p'); d.className='desc';
          d.textContent = it.desc || '';
          card.appendChild(d);

          const meta = document.createElement('div'); meta.className='meta';

          const needKey = (it.requireKey ?? cfg?.apiSettings?.defaultRequireKey) ? 'Requires API Key' : 'No Key';
          const keyPill = document.createElement('span'); keyPill.className='pill';
          keyPill.textContent = needKey; meta.appendChild(keyPill);

          if (it.example){
            const ex = document.createElement('span'); ex.className='pill';
            const base = (it.path || '').trim();
            const href = base.endsWith('=') ? (base + encodeURIComponent(it.example)) : base;
            ex.title = it.example; // tooltip di desktop
            ex.innerHTML = `Example: <a href="${href}" target="_blank" rel="noreferrer"><code>${it.example}</code></a>`;
            meta.appendChild(ex);
          }
          card.appendChild(meta);

          const actions = document.createElement('div'); actions.className='actions';
          const open = document.createElement('a'); open.className='open';
          open.textContent = 'Open Endpoint';
          const path = (it.path || '').trim();
          open.href = (path.endsWith('=') && it.example) ? (path + encodeURIComponent(it.example)) : path;
          open.target = '_blank'; open.rel = 'noreferrer';
          actions.appendChild(open);
          card.appendChild(actions);

          grid.appendChild(card);
        }

        sec.appendChild(grid);
        mount.appendChild(sec);
      }
    }
    main().catch(err=>{
      document.getElementById('content').innerHTML =
        `<div class="section"><div class="item">Gagal memuat konfigurasi: ${err?.message||err}</div></div>`;
    });
  </script>
</body>
</html>
