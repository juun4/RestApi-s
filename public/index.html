<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>JunnAPIs â€¢ Free & Simple REST Endpoints</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet"/>
  <style>
    :root{
      --bg:#0b1020; --surface:#0e1430; --card:#111736; --muted:#9aa4c7; --text:#e6ecff;
      --line:#1b2247; --pill:#2a3471; --acc:#7aa2ff; --acc2:#4ad295;
    }
    *{ box-sizing:border-box }
    html,body{ height:100% }
    body{ margin:0; font-family:Inter,system-ui,Segoe UI,Arial; background:var(--bg); color:var(--text) }
    a{ color:inherit; text-decoration:none }
    .wrap{ max-width:min(1200px,100vw - 32px); margin:0 auto; padding:24px }

    /* Header */
    header{ display:flex; align-items:center; justify-content:space-between; gap:16px; margin-bottom:16px; flex-wrap:wrap }
    .brand{ display:flex; gap:12px; align-items:center }
    .brand h1{ font-size:22px; margin:0 }
    .tag{ color:var(--muted); font-size:14px }
    .btn{ display:inline-flex; gap:8px; align-items:center; background:linear-gradient(90deg,var(--acc),var(--acc2)); color:#04102a; padding:8px 12px; border-radius:10px; font-weight:700 }

    /* Tabs kategori */
    .tabs{
      display:flex; gap:8px; overflow-x:auto; border-bottom:1px solid var(--line);
      padding-bottom:8px; margin-bottom:20px; scrollbar-width:none;
    }
    .tabs::-webkit-scrollbar{ display:none }
    .tab{
      padding:8px 14px; border-radius:10px; background:#141a3b;
      border:1px solid transparent; font-weight:600; color:var(--muted);
      cursor:pointer; white-space:nowrap; flex-shrink:0;
    }
    .tab.active{
      background:linear-gradient(90deg,var(--acc),var(--acc2));
      color:#04102a; border-color:var(--acc2);
    }

    /* Kartu dan grid */
    .section{ background:var(--surface); border:1px solid var(--line); border-radius:16px; padding:16px; box-shadow:0 10px 30px rgba(0,0,0,.18); margin-bottom:16px }
    .grid{ display:grid; gap:16px }
    @media (min-width:520px){ .grid{ grid-template-columns:repeat(2,minmax(0,1fr)); } }
    @media (min-width:900px){ .grid{ grid-template-columns:repeat(3,minmax(0,1fr)); } }
    @media (min-width:1180px){ .grid{ grid-template-columns:repeat(4,minmax(0,1fr)); } }

    .item{ background:var(--card); border:1px solid var(--line); border-radius:12px; padding:14px; display:flex; flex-direction:column; gap:10px; min-width:0; transition:transform .1s ease }
    .item:hover{ transform:translateY(-2px) }
    .title{ font-weight:700; margin:0 0 2px; line-height:1.25 }
    .desc{ margin:0; color:var(--muted); font-size:14px; line-height:1.5; word-break:break-word }

    /* meta: dua pill sebaris */
    .meta{ display:flex; gap:8px; align-items:center; flex-wrap:nowrap }
    .pill{
      display:inline-flex; align-items:center; gap:6px; padding:4px 8px;
      border:1px solid var(--pill); border-radius:999px; color:#c6d2ff;
      min-width:0; max-width:100%; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; font-size:12px;
    }
    .pill.key{ flex:0 0 auto }
    .pill.example{ flex:1 1 auto }
    .pill code,.pill a{ display:block; max-width:100%; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; color:#cfe1ff }

    .actions{ margin-top:auto }
    .open{ display:inline-flex; gap:8px; align-items:center; background:linear-gradient(90deg,var(--acc),var(--acc2)); color:#04102a; padding:9px 12px; border-radius:10px; font-weight:800 }

    footer{ margin-top:28px; color:var(--muted); font-size:13px; text-align:center }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <svg width="34" height="34" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M5 12h14M12 5v14" stroke="#7aa2ff" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <div>
          <h1 id="siteName">JunnAPIs</h1>
          <div class="tag" id="tagline">Free &amp; Simple REST Endpoints</div>
        </div>
      </div>
      <div style="display:flex; gap:10px; flex-wrap:wrap">
        <a id="repoLink" class="btn" target="_blank" rel="noreferrer">GitHub</a>
        <a id="deployLink" class="btn" target="_blank" rel="noreferrer">Open</a>
      </div>
    </header>

    <!-- Tab kategori -->
    <div id="tabs" class="tabs"></div>

    <!-- Konten -->
    <div id="content"></div>

    <footer>Made by <b id="creator">juun4</b></footer>
  </div>

  <script>
    async function main(){
      const res = await fetch('/src/web-set.json',{ cache:'no-store' });
      const cfg = await res.json();

      // branding
      document.getElementById('siteName').textContent = cfg?.branding?.siteName ?? 'JunnAPIs';
      document.getElementById('tagline').textContent  = cfg?.branding?.tagline  ?? 'Free & Simple REST Endpoints';
      document.getElementById('creator').textContent  = cfg?.apiSettings?.creator ?? 'unknown';
      document.getElementById('repoLink').href = cfg?.branding?.repo || '#';
      document.getElementById('deployLink').href = cfg?.branding?.deployUrl || '#';

      const categories = cfg.categories || [];
      const tabs = document.getElementById('tabs');
      const mount = document.getElementById('content');

      // buat tab per kategori
      categories.forEach((cat, i) => {
        const tab = document.createElement('div');
        tab.className = 'tab' + (i === 0 ? ' active' : '');
        tab.textContent = cat.title || 'Category';
        tab.addEventListener('click', () => {
          document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
          tab.classList.add('active');
          renderCategory(cat);
        });
        tabs.appendChild(tab);
      });

      // render kategori pertama
      if (categories[0]) renderCategory(categories[0]);

      function renderCategory(cat){
        mount.innerHTML = '';
        const sec = document.createElement('section');
        sec.className = 'section';
        const grid = document.createElement('div');
        grid.className = 'grid';

        (cat.items || []).forEach(it => {
          const card = document.createElement('div');
          card.className = 'item';
          const t = document.createElement('div');
          t.className = 'title';
          t.textContent = it.title || 'Untitled';
          const d = document.createElement('p');
          d.className = 'desc';
          d.textContent = it.desc || '';
          card.appendChild(t); card.appendChild(d);

          const meta = document.createElement('div');
          meta.className = 'meta';

          const keyPill = document.createElement('span');
          keyPill.className = 'pill key';
          keyPill.textContent = (it.requireKey ?? cfg.apiSettings?.defaultRequireKey) ? 'Requires API Key' : 'No Key';
          meta.appendChild(keyPill);

          if (it.example){
            const ex = document.createElement('span');
            ex.className = 'pill example';
            const base = (it.path || '').trim();
            const href = base.endsWith('=') ? (base + encodeURIComponent(it.example)) : base;
            ex.title = it.example;
            ex.innerHTML = `Example: <a href="${href}" target="_blank" rel="noreferrer"><code>${it.example}</code></a>`;
            meta.appendChild(ex);
          }

          card.appendChild(meta);

          if (it.path){
            const actions = document.createElement('div');
            actions.className = 'actions';
            const go = document.createElement('a');
            go.className = 'open';
            go.textContent = 'Open Endpoint';
            const base = (it.path || '').trim();
            go.href = (base.endsWith('=') && it.example) ? (base + encodeURIComponent(it.example)) : base;
            go.target = '_blank'; go.rel = 'noreferrer';
            actions.appendChild(go);
            card.appendChild(actions);
          }
          grid.appendChild(card);
        });

        sec.appendChild(grid);
        mount.appendChild(sec);
      }
    }

    main().catch(err=>{
      document.getElementById('content').innerHTML =
        `<div class="section"><div class="item">Gagal memuat konfigurasi: ${err?.message || err}</div></div>`;
    });
  </script>
</body>
</html>
