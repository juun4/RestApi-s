<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>JunnAPIs • Free & Simple REST Endpoints</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet"/>
  <style>
    :root{
      --bg:#0b1020; --surface:#0e1430; --card:#111736; --muted:#9aa4c7; --text:#e6ecff;
      --line:#1b2247; --pill:#2a3471; --acc:#7aa2ff; --acc2:#4ad295;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Arial;background:var(--bg);color:var(--text)}
    a{text-decoration:none;color:inherit;word-break:break-all}
    .wrap{max-width:min(900px,100vw - 32px);margin:0 auto;padding:24px}

    header{display:flex;align-items:center;justify-content:space-between;gap:16px;flex-wrap:wrap;margin-bottom:20px}
    .brand{display:flex;align-items:center;gap:12px}
    .brand h1{font-size:22px;margin:0}
    .tag{color:var(--muted);font-size:14px}
    .btn{display:inline-flex;align-items:center;gap:8px;background:linear-gradient(90deg,var(--acc),var(--acc2));
      color:#04102a;padding:8px 12px;border-radius:10px;font-weight:700}

    /* Tabs */
    .tabs{display:flex;gap:8px;overflow-x:auto;padding-bottom:10px;border-bottom:1px solid var(--line);scrollbar-width:none;margin-bottom:18px}
    .tabs::-webkit-scrollbar{display:none}
    .tab{padding:8px 14px;border-radius:10px;background:#141a3b;color:var(--muted);font-weight:600;cursor:pointer;flex-shrink:0;white-space:nowrap}
    .tab.active{background:linear-gradient(90deg,var(--acc),var(--acc2));color:#04102a}

    /* Cards */
    .section{background:var(--surface);border:1px solid var(--line);border-radius:16px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.18)}
    .grid{display:grid;gap:16px;grid-template-columns:1fr;}
    .item{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:14px;display:flex;flex-direction:column;gap:10px}
    .title{font-weight:700;margin:0}
    .desc{color:var(--muted);font-size:14px;margin:0}

    /* Meta pill */
    .meta{display:flex;flex-direction:column;gap:6px}
    .pill{
      display:flex;align-items:flex-start;flex-wrap:wrap;gap:6px;
      padding:6px 8px;border:1px solid var(--pill);
      border-radius:999px;color:#c6d2ff;font-size:12px;
      background:rgba(255,255,255,0.02);
    }
    .pill b{color:#cfe1ff;margin-right:4px;white-space:nowrap}
    .pill code{color:#cfe1ff;word-break:break-all;font-size:12px}

    .open{display:inline-flex;align-items:center;justify-content:center;background:linear-gradient(90deg,var(--acc),var(--acc2));
      color:#04102a;padding:9px 12px;border-radius:10px;font-weight:800;margin-top:auto;width:max-content}
    footer{margin-top:28px;color:var(--muted);font-size:13px;text-align:center}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <svg width="34" height="34" viewBox="0 0 24 24" fill="none"><path d="M5 12h14M12 5v14" stroke="#7aa2ff" stroke-width="2" stroke-linecap="round"/></svg>
        <div>
          <h1 id="siteName">JunnAPIs</h1>
          <div class="tag" id="tagline">Free & Simple REST Endpoints</div>
        </div>
      </div>
      <div style="display:flex;gap:10px;flex-wrap:wrap">
        <a id="repoLink" class="btn" target="_blank">GitHub</a>
        <a id="deployLink" class="btn" target="_blank">Open</a>
      </div>
    </header>

    <div id="tabs" class="tabs"></div>
    <div id="content"></div>

    <footer>Made by <b id="creator">juun4</b></footer>
  </div>

  <script>
  async function main(){
    const res = await fetch('/src/web-set.json',{cache:'no-store'});
    const cfg = await res.json();

    // Branding
    document.getElementById('siteName').textContent = cfg?.branding?.siteName ?? 'JunnAPIs';
    document.getElementById('tagline').textContent  = cfg?.branding?.tagline  ?? 'Free & Simple REST Endpoints';
    document.getElementById('creator').textContent  = cfg?.apiSettings?.creator ?? 'unknown';
    document.getElementById('repoLink').href = cfg?.branding?.repo || '#';
    document.getElementById('deployLink').href = cfg?.branding?.deployUrl || '#';

    const cats = cfg.categories || [];
    const tabs = document.getElementById('tabs');
    const content = document.getElementById('content');

    cats.forEach((cat,i)=>{
      const tab=document.createElement('div');
      tab.className='tab'+(i===0?' active':'');
      tab.textContent=cat.title||'Category';
      tab.addEventListener('click',()=>{
        document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
        tab.classList.add('active');
        render(cat);
      });
      tabs.appendChild(tab);
    });

    if(cats[0]) render(cats[0]);

    function render(cat){
      content.innerHTML='';
      const section=document.createElement('section');
      section.className='section';
      const grid=document.createElement('div');
      grid.className='grid';

      (cat.items||[]).forEach(it=>{
        const card=document.createElement('div');
        card.className='item';
        const t=document.createElement('div');
        t.className='title';
        t.textContent=it.title||'Untitled';
        const d=document.createElement('p');
        d.className='desc';
        d.textContent=it.desc||'';
        card.appendChild(t);
        card.appendChild(d);

        const meta=document.createElement('div');
        meta.className='meta';

        const key=document.createElement('div');
        key.className='pill';
        key.textContent=(it.requireKey ?? cfg.apiSettings?.defaultRequireKey) ? 'Requires API Key' : 'No Key';
        meta.appendChild(key);

        if(it.example){
          const ex=document.createElement('div');
          ex.className='pill';
          ex.innerHTML = `<b>Example:</b> <code>${it.example}</code>`;
          meta.appendChild(ex);
        }
        card.appendChild(meta);

        // ✅ FIX: proper raw URL (no encode)
        if(it.path){
          const go=document.createElement('a');
          go.className='open';
          go.textContent='Open Endpoint';

          let href = (it.path||'').trim();
          // detect query params
          if (href.includes('url=') && href.includes('apikey=')) {
            const [base, q] = href.split('?');
            const params = new URLSearchParams(q);
            if (params.has('url')) params.set('url', it.example || '');
            href = `${base}?${params.toString()}`;
          } else if (href.endsWith('=') && it.example) {
            href += it.example; // raw, no encode
          }
          go.href = href;
          go.target = '_blank';
          card.appendChild(go);
        }
        grid.appendChild(card);
      });
      section.appendChild(grid);
      content.appendChild(section);
    }
  }

  main().catch(e=>{
    document.getElementById('content').innerHTML=`<div class='section'><div class='item'>Error: ${e.message}</div></div>`;
  });
  </script>
</body>
</html>
